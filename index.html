<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-900">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Martial Arts Manager 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for the event log */
        .log-container::-webkit-scrollbar {
            width: 8px;
        }
        .log-container::-webkit-scrollbar-track {
            background: #2d3748; /* gray-800 */
        }
        .log-container::-webkit-scrollbar-thumb {
            background: #4a5568; /* gray-600 */
            border-radius: 4px;
        }
        .log-container::-webkit-scrollbar-thumb:hover {
            background: #718096; /* gray-500 */
        }
    </style>
</head>
<body class="h-full text-gray-100">
    <div id="app" class="flex flex-col h-screen">

        <!-- Character Creation Screen -->
        <div id="creation-screen" class="flex items-center justify-center h-full p-4">
            <div class="w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-8">
                <h1 class="text-3xl font-bold text-center text-white mb-6">Create Your Legacy</h1>
                
                <div class="mb-4">
                    <label for="player-name" class="block text-sm font-medium text-gray-300 mb-1">Enter Your Name</label>
                    <input type="text" id="player-name" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., John 'Hands of Stone' Doe">
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-300 mb-1">Choose Your Path</label>
                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="selectPath('fighter')" class="career-path-btn flex flex-col items-center justify-center p-4 bg-gray-700 rounded-lg hover:bg-blue-600 hover:text-white transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>
                            <span class="font-medium">Fighter</span>
                        </button>
                        <button disabled title="Coming in a future version!" class="disabled-btn flex flex-col items-center justify-center p-4 bg-gray-700 rounded-lg opacity-50 cursor-not-allowed">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-2" viewBox="0 0 20 20" fill="currentColor"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v-1h8v1zM3 8a2 2 0 11-4 0 2 2 0 014 0zM6 15a4 4 0 00-8 0v-1h8v1z" /><path d="M11 3.055A9.001 9.001 0 0119 12v1a4 4 0 01-8 0v-1a9.001 9.001 0 01-1.464-5.062l.156.311A4.002 4.002 0 0113 11a4 4 0 01-4 4 4 4 0 01-4-4 4 4 0 011.308-2.752l.156-.311A9.001 9.001 0 011 12v1a4 4 0 01-8 0v-1a9.001 9.001 0 0116.945-4.945z" /></svg>
                            <span class="font-medium">Coach</span>
                        </button>
                        <button disabled title="Coming in a future version!" class="disabled-btn flex flex-col items-center justify-center p-4 bg-gray-700 rounded-lg opacity-50 cursor-not-allowed">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-2" viewBox="0 0 20 20" fill="currentColor"><path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z" /></svg>
                            <span class="font-medium">Manager</span>
                        </button>
                        <button disabled title="Coming in a future version!" class="disabled-btn flex flex-col items-center justify-center p-4 bg-gray-700 rounded-lg opacity-50 cursor-not-allowed">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 mb-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H4zm10 10H6v2h8v-2zm0-4H6v2h8V8z" clip-rule="evenodd" /></svg>
                            <span class="font-medium">Promoter</span>
                        </button>
                    </div>
                </div>

                <div id="discipline-select" class="mb-6 hidden">
                    <label class="block text-sm font-medium text-gray-300 mb-1">Choose Your Base</label>
                    <select id="fighter-discipline" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="muay-thai">Muay Thai (High Striking)</option>
                        <option value="bjj">BJJ (High Grappling)</option>
                        <option value="boxing">Boxing (Good Striking, Good Stamina)</option>
                        <option value="mma">MMA (Well-Rounded)</option>
                    </select>
                </div>

                <button id="start-game-btn" onclick="startGame()" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-500 transition-colors duration-150 disabled:opacity-50" disabled>
                    Start Career
                </button>
            </div>
        </div>

        <!-- Main Game Hub (Fighter) -->
        <div id="hub-screen" class="hidden flex-grow flex-col">
            <!-- Header -->
            <header class="bg-gray-800 shadow-md">
                <div class="container mx-auto px-4 py-3 flex flex-wrap justify-between items-center">
                    <h1 id="hub-player-name" class="text-xl md:text-2xl font-bold text-white"></h1>
                    <div class="flex space-x-4 md:space-x-6 text-sm md:text-base">
                        <span id="hub-date" class="text-gray-300">Week 1, Jan 2026</span>
                        <span id="hub-money" class="text-green-400 font-semibold">$500</span>
                        <span id="hub-record" class="text-gray-300">Record: 0-0-0</span>
                    </div>
                </div>
            </header>

            <!-- Main Content Grid -->
            <main class="flex-grow p-4 container mx-auto grid grid-cols-1 lg:grid-cols-3 gap-4">
                
                <!-- Left Column: Stats -->
                <section class="lg:col-span-1 bg-gray-800 rounded-lg shadow-lg p-5">
                    <h2 class="text-xl font-semibold mb-4 border-b border-gray-700 pb-2">Fighter Profile</h2>
                    
                    <!-- Health & Stamina Bars -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium">Health</label>
                        <div class="w-full bg-gray-700 rounded-full h-5">
                            <div id="stat-health-bar" class="bg-red-600 h-5 rounded-full text-xs font-medium text-white text-center p-0.5 leading-none" style="width: 100%">
                                <span id="stat-health-text">100 / 100</span>
                            </div>
                        </div>
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium">Stamina (Energy)</label>
                        <div class="w-full bg-gray-700 rounded-full h-5">
                            <div id="stat-stamina-bar" class="bg-blue-600 h-5 rounded-full text-xs font-medium text-white text-center p-0.5 leading-none" style="width: 100%">
                                <span id="stat-stamina-text">100 / 100</span>
                            </div>
                        </div>
                    </div>

                    <!-- Core Stats -->
                    <h3 class="text-lg font-semibold mb-3">Attributes</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300">Striking</span>
                            <span id="stat-striking" class="font-bold text-lg text-blue-300">10</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300">Grappling</span>
                            <span id="stat-grappling" class="font-bold text-lg text-blue-300">10</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300">Strength</span>
                            <span id="stat-strength" class="font-bold text-lg text-blue-300">10</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-300">Fame</span>
                            <span id="stat-fame" class="font-bold text-lg text-yellow-300">0</span>
                        </div>
                    </div>
                </section>

                <!-- Middle Column: Actions -->
                <section class="lg:col-span-1 bg-gray-800 rounded-lg shadow-lg p-5">
                    <h2 class="text-xl font-semibold mb-4 border-b border-gray-700 pb-2">Weekly Actions</h2>
                    <p id="action-status" class="text-center text-yellow-400 font-medium mb-3">Choose an action for the week.</p>
                    <div id="action-buttons" class="flex flex-col space-y-3">
                        <button onclick="performAction('train-striking')" class="action-btn" title="Cost: $50, -20 Stamina">
                            <span>Train Striking</span>
                            <span class="text-xs text-gray-300">(+Skill, -Stamina, -$Money)</span>
                        </button>
                        <button onclick="performAction('train-grappling')" class="action-btn" title="Cost: $50, -20 Stamina">
                            <span>Train Grappling</span>
                            <span class="text-xs text-gray-300">(+Skill, -Stamina, -$Money)</span>
                        </button>
                        <button onclick="performAction('train-strength')" class="action-btn" title="Cost: $50, -20 Stamina">
                            <span>Strength & Conditioning</span>
                            <span class="text-xs text-gray-300">(+Skill, -Stamina, -$Money)</span>
                        </button>
                        <button onclick="performAction('rest')" class="action-btn" title="Free">
                            <span>Rest & Recover</span>
                            <span class="text-xs text-gray-300">(+Stamina, +Health)</span>
                        </button>
                        <button onclick="performAction('promote')" class="action-btn" title="Cost: -15 Stamina">
                            <span>Promote Yourself ✨</span>
                            <span class="text-xs text-gray-300">(+Fame, -Stamina)</span>
                        </button>
                        <button onclick="performAction('find-fight')" class="w-full text-left p-3 bg-green-600 text-white rounded-lg shadow-md hover:bg-green-500 transition-colors duration-150 font-bold">
                            <span>Find a Fight</span>
                            <span class="block text-xs text-green-100">(Risk vs Reward, +Fame, +$Money)</span>
                        </button>
                    </div>
                    <div id="action-busy" class="hidden text-center">
                        <p class="text-lg font-semibold text-blue-300" id="busy-message">Simulating week...</p>
                        <button onclick="advanceWeek()" class="mt-4 w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-500 transition-colors duration-150">
                            Continue
                        </button>
                    </div>
                </section>

                <!-- Right Column: Event Log -->
                <section class="lg:col-span-1 bg-gray-800 rounded-lg shadow-lg p-5 flex flex-col">
                    <h2 class="text-xl font-semibold mb-4 border-b border-gray-700 pb-2">Career Log</h2>
                    <div id="event-log" class="log-container flex-grow h-64 lg:h-auto overflow-y-auto pr-2 space-y-3">
                        <!-- Log messages will be injected here -->
                    </div>
                </section>
            </main>
        </div>

    </div>

    <!-- Modal Container -->
    <div id="modal-backdrop" class="hidden fixed inset-0 bg-black bg-opacity-75 z-40"></div>
    <div id="modal-container" class="hidden fixed inset-0 flex items-center justify-center z-50 p-4">
        
        <!-- Find Fight Modal -->
        <div id="modal-find-fight" class="modal-content hidden w-full max-w-lg bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4">Fight Offer</h2>
            <p class="mb-4">Your manager found a potential opponent. This is an amateur bout at a local gym.</p>
            <div class="mb-6 p-4 bg-gray-700 rounded-lg">
                <h3 id="opponent-name" class="text-xl font-semibold text-red-300"></h3>
                <div class="flex justify-between mt-2">
                    <span>Striking: <span id="opponent-striking" class="font-medium"></span></span>
                    <span>Grappling: <span id="opponent-grappling" class="font-medium"></span></span>
                </div>
                <div class="mt-3 pt-3 border-t border-gray-600">
                    <p>Purse: <span id="fight-purse-win" class="text-green-400 font-bold"></span> (Win), <span id="fight-purse-lose" class="text-yellow-400 font-bold"></span> (Lose)</p>
                </div>
            </div>
            <div class="flex justify-end space-x-3">
                <button onclick="scoutOpponent()" id="scout-opponent-btn" class="px-5 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold">✨ Get Scouting Report</button>
                <button onclick="declineFight()" class="px-5 py-2 bg-gray-600 rounded-md hover:bg-gray-500 transition-colors">Decline Fight</button>
                <button onclick="acceptFight()" class="px-5 py-2 bg-red-600 rounded-md hover:bg-red-500 transition-colors font-semibold">Accept Fight</button>
            </div>
        </div>

        <!-- Fight Sim Modal -->
        <div id="modal-fight-sim" class="modal-content hidden w-full max-w-lg bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-center">FIGHT NIGHT</h2>
            <div id="fight-sim-log" class="h-48 bg-gray-900 rounded-md p-3 overflow-y-auto mb-4 font-mono text-sm space-y-1">
                <!-- Sim results go here -->
            </div>
            <h3 id="fight-result-text" class="text-2xl font-bold text-center mb-4"></h3>
            <p id="fight-payout-text" class="text-lg text-center mb-4"></p>
            <div class="flex justify-center">
                <button onclick="closeModal()" class="px-8 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold">Continue Career</button>
            </div>
        </div>

        <!-- Random Event Modal -->
        <div id="modal-event" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 id="event-title" class="text-2xl font-bold mb-4"></h2>
            <p id="event-description" class="mb-6"></p>
            <div class="flex justify-center">
                <button onclick="closeModal(finishWeek)" class="px-8 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold">OK</button>
            </div>
        </div>

        <!-- Bribe Offer Modal -->
        <div id="modal-bribe-offer" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-yellow-400">An 'Easy' Payday?</h2>
            <p class="mb-6">Your next opponent's manager pulls you aside. "He needs this win, kid. Take a dive in the 2nd round, and there's $1000 in it for you."</p>
            <div class="flex flex-col space-y-3">
                <button onclick="acceptBribe()" class="w-full px-5 py-2 bg-green-600 rounded-md hover:bg-green-500 transition-colors font-semibold">Take the Bribe ($1000)</button>
                <button onclick="refuseBribe()" class="w-full px-5 py-2 bg-gray-600 rounded-md hover:bg-gray-500 transition-colors">Refuse the Bribe</button>
            </div>
        </div>

        <!-- Mob Approach Modal -->
        <div id="modal-mob-approach" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-red-500">A Shady Offer</h2>
            <p class="mb-6">A well-dressed man approaches you after training. "We like your potential. We could... help your career. For a price." He offers to 'fix' your next match for a cut of the winnings.</p>
            <div class="flex flex-col space-y-3">
                <button onclick="acceptMobHelp()" class="w-full px-5 py-2 bg-red-600 rounded-md hover:bg-red-500 transition-colors font-semibold">Accept the "help"</button>
                <button onclick="refuseMobHelp()" class="w-full px-5 py-2 bg-gray-600 rounded-md hover:bg-gray-500 transition-colors">"No thanks, I'm good"</button>
            </div>
        </div>

        <!-- NEW: Scouting Report Modal -->
        <div id="modal-scout-report" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-blue-300">Coach's Report ✨</h2>
            <div id="scout-report-content" class="mb-6 p-4 bg-gray-700 rounded-lg min-h-[100px]">
                <!-- Loading spinner -->
                <div id="scout-loading" class="flex justify-center items-center">
                    <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="ml-3">Coach is watching tape...</span>
                </div>
                <!-- Report text -->
                <p id="scout-report-text" class="hidden"></p>
                <p id="scout-report-error" class="hidden text-red-400"></p>
            </div>
            <div class="flex justify-center">
                <button onclick="closeModal()" class="px-8 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold">Close Report</button>
            </div>
        </div>

        <!-- NEW: Promote Hype Modal -->
        <div id="modal-promote-hype" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6">
            <h2 class="text-2xl font-bold mb-4 text-yellow-300">Fight Hype! ✨</h2>
            <div id="promote-hype-content" class="mb-6 p-4 bg-gray-700 rounded-lg min-h-[100px]">
                <!-- Loading spinner -->
                <div id="promote-loading" class="flex justify-center items-center">
                    <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="ml-3">Generating hype...</span>
                </div>
                <!-- Hype text -->
                <p id="promote-hype-text" class="hidden font-mono text-lg"></p>
                <p id="promote-hype-error" class="hidden text-red-400"></p>
            </div>
            <div class="flex justify-center">
                <button id="post-hype-btn" onclick="closeModal(finishWeek)" class="px-8 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold hidden">Post It!</button>
            </div>
        </div>


        <!-- Game Over Modal -->
        <div id="modal-game-over" class="modal-content hidden w-full max-w-md bg-gray-800 rounded-lg shadow-xl p-6 text-center">
            <h2 id="game-over-title" class="text-3xl font-bold mb-4 text-red-500"></h2>
            <p id="game-over-description" class="text-lg mb-6"></p>
            <div class="flex justify-center">
                <button onclick="window.location.reload()" class="px-8 py-2 bg-blue-600 rounded-md hover:bg-blue-500 transition-colors font-semibold">Start New Career</button>
            </div>
        </div>
        
    </div>

    <script>
        // --- DOM Elements ---
        const creationScreen = document.getElementById('creation-screen');
        const hubScreen = document.getElementById('hub-screen');
        const startGameBtn = document.getElementById('start-game-btn');
        const disciplineSelect = document.getElementById('discipline-select');
        const eventLog = document.getElementById('event-log');
        const actionButtons = document.getElementById('action-buttons');
        const actionBusy = document.getElementById('action-busy');
        const busyMessage = document.getElementById('busy-message');

        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalContainer = document.getElementById('modal-container');
        const allModals = document.querySelectorAll('.modal-content');

        const modalFindFight = document.getElementById('modal-find-fight');
        const modalFightSim = document.getElementById('modal-fight-sim');
        const modalEvent = document.getElementById('modal-event');
        const modalBribeOffer = document.getElementById('modal-bribe-offer');
        const modalMobApproach = document.getElementById('modal-mob-approach');
        const modalGameOver = document.getElementById('modal-game-over');
        const modalScoutReport = document.getElementById('modal-scout-report'); // NEW
        const modalPromoteHype = document.getElementById('modal-promote-hype'); // NEW

        // --- Game State ---
        let gameState = {
            playerName: "",
            discipline: "",
            week: 1,
            year: 2026,
            stats: {
                money: 500,
                health: 100,
                maxHealth: 100,
                stamina: 100,
                maxStamina: 100,
                striking: 10,
                grappling: 10,
                strength: 10,
                fame: 0,
            },
            record: {
                wins: 0,
                losses: 0,
                draws: 0
            },
            currentOpponent: null,
            isBusy: false,
            pendingAction: null,
            isTakingDive: false, // NEW
            isMobHelping: false, // NEW
            isApiLoading: false, // NEW
        };

        // --- Gemini API ---

        /**
         * Calls the Gemini API with exponential backoff.
         * @param {string} prompt The prompt to send to the API.
         * @param {number} retries Number of retries left.
         * @param {number} delay Current delay in ms.
         * @returns {Promise<string>} The generated text.
         */
        async function callGemini(prompt, retries = 5, delay = 1000) {
            gameState.isApiLoading = true;
            const apiKey = ""; // Leave empty, will be handled by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                // Add safety settings if needed
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    gameState.isApiLoading = false;
                    return candidate.content.parts[0].text;
                } else {
                    throw new Error("Invalid API response structure.");
                }

            } catch (error) {
                console.error("API Call Error:", error);
                if (retries > 0) {
                    console.log(`Retrying in ${delay}ms... (${retries} retries left)`);
                    await new Promise(res => setTimeout(res, delay));
                    return callGemini(prompt, retries - 1, delay * 2); // Exponential backoff
                } else {
                    gameState.isApiLoading = false;
                    throw new Error("API call failed after multiple retries.");
                }
            }
        }


        // --- Character Creation ---
        function selectPath(path) {
            // This function is simple now but can be expanded for other paths
            if (path === 'fighter') {
                console.log("Fighter path selected");
            }
        }

        function startGame() {
            const playerNameInput = document.getElementById('player-name');
            const discipline = document.getElementById('fighter-discipline').value;
            
            if (!playerNameInput.value) {
                alert("Please enter a name.");
                return;
            }

            gameState.playerName = playerNameInput.value;
            gameState.discipline = discipline;

            // Set initial stats based on discipline
            switch(discipline) {
                case 'muay-thai':
                    gameState.stats.striking += 5;
                    gameState.stats.grappling -= 2;
                    break;
                case 'bjj':
                    gameState.stats.striking -= 2;
                    gameState.stats.grappling += 5;
                    break;
                case 'boxing':
                    gameState.stats.striking += 3;
                    gameState.stats.maxStamina += 10;
                    gameState.stats.stamina += 10;
                    break;
                case 'mma':
                    gameState.stats.striking += 1;
                    gameState.stats.grappling += 1;
                    gameState.stats.strength += 1;
                    break;
            }

            // Hide creation screen, show hub
            creationScreen.classList.add('hidden');
            hubScreen.classList.remove('hidden');

            // Initial UI Update
            document.getElementById('hub-player-name').textContent = gameState.playerName;
            addLogMessage(`Your career as a ${discipline} fighter begins!`, 'success');
            updateUI();
        }

        // --- Core Game Loop ---

        function performAction(action) {
            if (gameState.isBusy) return;

            gameState.isBusy = true;
            gameState.pendingAction = action;

            actionButtons.classList.add('hidden');
            actionBusy.classList.remove('hidden');
            busyMessage.classList.remove('hidden');

            switch(action) {
                case 'train-striking':
                case 'train-grappling':
                case 'train-strength':
                    if (gameState.stats.money < 50) {
                        addLogMessage("Not enough money to train.", 'warning');
                        gameState.isBusy = false;
                        gameState.pendingAction = null;
                        actionButtons.classList.remove('hidden');
                        actionBusy.classList.add('hidden');
                        return;
                    }
                    if (gameState.stats.stamina < 20) {
                        addLogMessage("Not enough stamina to train.", 'warning');
                        gameState.isBusy = false;
                        gameState.pendingAction = null;
                        actionButtons.classList.remove('hidden');
                        actionBusy.classList.add('hidden');
                        return;
                    }
                    busyMessage.textContent = "Training hard...";
                    break;
                case 'rest':
                    if (gameState.stats.stamina >= gameState.stats.maxStamina && gameState.stats.health >= gameState.stats.maxHealth) {
                        addLogMessage("You are already at full health and stamina.", 'info');
                        gameState.isBusy = false;
                        gameState.pendingAction = null;
                        actionButtons.classList.remove('hidden');
                        actionBusy.classList.add('hidden');
                        return;
                    }
                    busyMessage.textContent = "Resting and recovering...";
                    break;
                case 'promote': // NEW
                    if (gameState.stats.stamina < 15) {
                        addLogMessage("Not enough stamina to promote yourself.", 'warning');
                        gameState.isBusy = false;
                        return;
                    }
                    busyMessage.textContent = "Generating fight hype...";
                    generateFightHype(); // Call Gemini
                    updateUI();
                    return; // Don't call advanceWeek yet
                case 'find-fight':
                    // Check for bribe/mob flags *before* finding a new fight
                    if (gameState.isTakingDive) {
                        addLogMessage("You have to take a dive first! You can't back out.", 'danger');
                        gameState.isBusy = false;
                        gameState.pendingAction = null;
                        actionButtons.classList.remove('hidden');
                        actionBusy.classList.add('hidden');
                        return;
                    }
                     if (gameState.isMobHelping) {
                        addLogMessage("The mob is waiting for their 'fixed' fight. You can't fight anyone else.", 'danger');
                        gameState.isBusy = false;
                        gameState.pendingAction = null;
                        actionButtons.classList.remove('hidden');
                        actionBusy.classList.add('hidden');
                        return;
                    }

                    busyMessage.textContent = "Manager is making calls...";
                    // Simulate finding a fight
                    setTimeout(() => {
                        generateFightOffer();
                        showModal('modal-find-fight');
                    }, 1000); // 1 second delay
                    return; // Don't call advanceWeek yet
            }

            // Simulate time passing for the action
            setTimeout(advanceWeek, 1000);
        }

        function advanceWeek() {
            // Hide the 'Continue' button if it was shown
            actionBusy.classList.add('hidden');
            busyMessage.classList.remove('hidden');
            busyMessage.textContent = "Simulating week...";
            
            // This is the main function call that processes the action AND random events
            handleRandomEvent();
            // finishWeek() is now called by handleRandomEvent() or the modal close function
        }

        function handleRandomEvent() {
            // Check for game over conditions first
            if (gameState.stats.money < -100 && gameState.pendingAction !== 'find-fight') {
                gameOver("Bankrupt!", "You ran out of money and your gym kicked you out. Your career is over.");
                return;
            }

            // Don't have random events if a fight is booked
            if (gameState.pendingAction === 'fight') {
                finishWeek();
                return;
            }

            const eventChance = Math.random();

            // 15% chance of a random event
            if (eventChance < 0.15) {
                const eventType = Math.random();
                
                if (eventType < 0.33) {
                    // Simple event
                    showModal('modal-event');
                    document.getElementById('event-title').textContent = "Minor Injury";
                    document.getElementById('event-description').textContent = "You tweaked your knee in training. You lose 10 Health.";
                    gameState.stats.health = Math.max(0, gameState.stats.health - 10);
                    addLogMessage("You suffered a minor injury in training. -10 Health.", 'warning');
                } else if (eventType < 0.66) {
                    // Simple event
                    showModal('modal-event');
                    document.getElementById('event-title').textContent = "Local Sponsor";
                    document.getElementById('event-description').textContent = "A local noodle shop wants to sponsor you! You get an extra $100.";
                    gameState.stats.money += 100;
                    addLogMessage("A local sponsor gave you $100!", 'success');
                } else {
                    // Simple event
                    showModal('modal-event');
                    document.getElementById('event-title').textContent = "Overtrained";
                    document.getElementById('event-description').textContent = "You pushed too hard. You feel drained. -10 Stamina.";
                    gameState.stats.stamina = Math.max(0, gameState.stats.stamina - 10);
                    addLogMessage("You overtrained and feel exhausted. -10 Stamina.", 'warning');
                }
                // 'finishWeek' will be called when the modal's "OK" button is clicked
            } else {
                // No event, just finish the week
                finishWeek();
            }
        }

        function finishWeek() {
            // This function now *only* processes the action and updates stats
            // It's called *after* any random event is handled
            
            const action = gameState.pendingAction;
            
            // Process the action
            if (action === 'train-striking') {
                gameState.stats.money -= 50;
                gameState.stats.stamina -= 20;
                let gain = Math.floor(Math.random() * 3) + 1; // 1-3 gain
                gameState.stats.striking += gain;
                addLogMessage(`You trained striking. Skill +${gain}, $ -50, Stamina -20.`, 'info');
            }
            else if (action === 'train-grappling') {
                gameState.stats.money -= 50;
                gameState.stats.stamina -= 20;
                let gain = Math.floor(Math.random() * 3) + 1;
                gameState.stats.grappling += gain;
                addLogMessage(`You trained grappling. Skill +${gain}, $ -50, Stamina -20.`, 'info');
            }
            else if (action === 'train-strength') {
                gameState.stats.money -= 50;
                gameState.stats.stamina -= 20;
                let gain = Math.floor(Math.random() * 3) + 1;
                gameState.stats.strength += gain;
                addLogMessage(`You trained strength. Skill +${gain}, $ -50, Stamina -20.`, 'info');
            }
            else if (action === 'rest') {
                let staminaGain = Math.floor(gameState.stats.maxStamina * 0.5); // 50% recovery
                let healthGain = Math.floor(gameState.stats.maxHealth * 0.1); // 10% recovery
                gameState.stats.stamina = Math.min(gameState.stats.maxStamina, gameState.stats.stamina + staminaGain);
                gameState.stats.health = Math.min(gameState.stats.maxHealth, gameState.stats.health + healthGain);
                addLogMessage(`You rested. Stamina +${staminaGain}, Health +${healthGain}.`, 'info');
            }
            else if (action === 'promote') { // NEW
                let staminaCost = 15;
                let fameGain = Math.floor(Math.random() * 3) + 1; // 1-3 fame
                gameState.stats.stamina -= staminaCost;
                gameState.stats.fame += fameGain;
                addLogMessage(`You promoted yourself. -${staminaCost} Stamina, +${fameGain} Fame.`, 'success');
            }
            else if (action === 'fight') {
                // Handled by simulateFight()
            }
        
            // --- Weekly Upkeep ---
            
            // Passive stamina/health regen
            if (action !== 'rest' && action !== 'fight') {
                if (gameState.stats.stamina < gameState.stats.maxStamina) {
                    gameState.stats.stamina = Math.min(gameState.stats.maxStamina, gameState.stats.stamina + 5);
                }
                if (gameState.stats.health < gameState.stats.maxHealth) {
                    gameState.stats.health = Math.min(gameState.stats.maxHealth, gameState.stats.health + 2);
                }
            }
            
            // Pay weekly bills
            let bills = 20;
            gameState.stats.money -= bills;
            addLogMessage(`Paid weekly living expenses: $${bills}.`, 'normal');

            // Advance date
            gameState.week++;
            if (gameState.week > 52) {
                gameState.week = 1;
                gameState.year++;
            }

            // Reset state
            gameState.isBusy = false;
            gameState.pendingAction = null;
            actionButtons.classList.remove('hidden');
            actionBusy.classList.add('hidden');

            updateUI();
            
            // Check for game over *after* update, so player sees final stats
            if (gameState.stats.health <= 0) {
                gameOver("Career-Ending Injury", "Your body is broken. You can no longer compete. Your career is over.");
            }
        }

        // --- NEW Gemini Features ---

        async function scoutOpponent() {
            if (gameState.isApiLoading || !gameState.currentOpponent) return;
            
            const player = gameState.stats;
            const opp = gameState.currentOpponent;
            const scoutBtn = document.getElementById('scout-opponent-btn');
            scoutBtn.disabled = true;

            // Show modal with loading state
            showModal('modal-scout-report');
            document.getElementById('scout-loading').classList.remove('hidden');
            document.getElementById('scout-report-text').classList.add('hidden');
            document.getElementById('scout-report-error').classList.add('hidden');

            const prompt = `Act as a grizzled, old-school fight coach. My fighter, ${gameState.playerName}, is about to fight ${opp.name}.
My fighter's stats: Striking ${player.striking}, Grappling ${player.grappling}.
Opponent's stats: Striking ${opp.striking}, Grappling ${opp.grappling}.
Give me a short, punchy, 1-2 sentence breakdown of the opponent and a tactical game plan. Be direct and use colorful language, like a coach in a movie.`;

            try {
                const report = await callGemini(prompt);
                document.getElementById('scout-report-text').innerText = `"${report}"`;
                document.getElementById('scout-report-text').classList.remove('hidden');
            } catch (error) {
                console.error("Scouting Error:", error);
                document.getElementById('scout-report-error').innerText = "Coach is busy... try again later.";
                document.getElementById('scout-report-error').classList.remove('hidden');
            } finally {
                document.getElementById('scout-loading').classList.add('hidden');
                scoutBtn.disabled = false;
            }
        }

        async function generateFightHype() {
            if (gameState.isApiLoading) return;

            // Show modal with loading state
            showModal('modal-promote-hype');
            document.getElementById('promote-loading').classList.remove('hidden');
            document.getElementById('promote-hype-text').classList.add('hidden');
            document.getElementById('promote-hype-error').classList.add('hidden');
            document.getElementById('post-hype-btn').classList.add('hidden');

            const player = gameState.stats;
            const strongestStat = player.striking > player.grappling ? 'devastating striking' : 'slick grappling';

            const prompt = `Act as a modern, energetic fight promoter on social media.
Generate a short, exciting social media post (1-2 sentences, max 140 chars) for an up-and-coming ${gameState.discipline} fighter named ${gameState.playerName}.
Their record is ${gameState.record.wins}-${gameState.record.losses}. They are known for their ${strongestStat}.
Use hashtags and emojis. Make it punchy!`;

            try {
                const hype = await callGemini(prompt);
                document.getElementById('promote-hype-text').innerText = hype;
                document.getElementById('promote-hype-text').classList.remove('hidden');
                document.getElementById('post-hype-btn').classList.remove('hidden');
            } catch (error) {
                console.error("Hype Error:", error);
                document.getElementById('promote-hype-error').innerText = "Couldn't connect to social media... try again later.";
                document.getElementById('promote-hype-error').classList.remove('hidden');
                // If it fails, just give a default "Post It!" button to continue the week
                document.getElementById('post-hype-btn').classList.remove('hidden');
            } finally {
                document.getElementById('promote-loading').classList.add('hidden');
            }
        }


        // --- Shady Event Handlers ---

        function offerBribe() {
            // This is called just before a fight
            if (Math.random() < 0.25) { // 25% chance of bribe offer
                showModal('modal-bribe-offer');
                // The fight sim is paused until a choice is made
                return true; // Bribe was offered
            }
            return false; // No bribe
        }

        function acceptBribe() {
            addLogMessage("You agreed to take a dive. Don't mess this up...", 'warning');
            gameState.isTakingDive = true;
            gameState.stats.money += 1000; // Get paid upfront
            addLogMessage("You were paid $1000. Now you have to lose.", 'success');
            closeModal(() => simulateFight(true)); // Pass 'true' to force loss
        }

        function refuseBribe() {
            addLogMessage("You refused the bribe. Good for you.", 'info');
            closeModal(() => simulateFight(false)); // Fight normally
        }

        function offerMobHelp() {
            // This is called just before a fight
             if (Math.random() < 0.25) { // 25% chance of mob offer
                showModal('modal-mob-approach');
                // The fight sim is paused until a choice is made
                return true; // Mob offer
            }
            return false; // No offer
        }
        
        function acceptMobHelp() {
            addLogMessage("You accepted the mob's 'help'. This is a dangerous game...", 'danger');
            gameState.isMobHelping = true;
            closeModal(() => simulateFight(false, true)); // Pass 'true' to force win
        }

        function refuseMobHelp() {
            addLogMessage("You refused the mob. They don't look happy...", 'warning');
            // Add a chance of them "punishing" you
            if (Math.random() < 0.3) {
                addLogMessage("The mob paid off the ref! You'll be at a disadvantage.", 'danger');
                // Simulate disadvantage (e.g., lower your stats for this fight)
                gameState.currentOpponent.striking += 5; // Make opponent stronger
            }
            closeModal(() => simulateFight(false, false)); // Fight normally
        }


        // --- Fight Sim ---

        function generateFightOffer() {
            // Generate a slightly tougher opponent each time
            const baseStat = 8;
            const scaling = gameState.record.wins * 2;
            
            const name = "Rival Fighter"; // Simple name for now
            const striking = baseStat + scaling + Math.floor(Math.random() * 5); // 0-4
            const grappling = baseStat + scaling + Math.floor(Math.random() * 5); // 0-4
            
            const purseWin = 200 + (gameState.stats.fame * 10);
            const purseLose = 50 + (gameState.stats.fame * 5);

            gameState.currentOpponent = { name, striking, grappling, purseWin, purseLose };

            // Update modal
            document.getElementById('opponent-name').textContent = name;
            document.getElementById('opponent-striking').textContent = striking;
            document.getElementById('opponent-grappling').textContent = grappling;
            document.getElementById('fight-purse-win').textContent = `$${purseWin}`;
            document.getElementById('fight-purse-lose').textContent = `$${purseLose}`;
        }

        function acceptFight() {
            addLogMessage(`Fight accepted against ${gameState.currentOpponent.name}!`, 'info');
            gameState.pendingAction = 'fight'; // Lock in the action
            
            // Reset scouting report button
            const scoutBtn = document.getElementById('scout-opponent-btn');
            scoutBtn.disabled = false;
            document.getElementById('scout-report-text').classList.add('hidden');
            document.getElementById('scout-report-error').classList.add('hidden');

            // Check for shady events *before* closing the modal
            if (offerBribe()) {
                // Modal is now open, wait for player choice
                return;
            }
            if (offerMobHelp()) {
                // Modal is now open, wait for player choice
                return;
            }

            // No shady events, proceed to simulation
            closeModal(() => simulateFight(false, false));
        }

        function declineFight() {
            addLogMessage("You declined the fight.", 'normal');
            gameState.isBusy = false;
            gameState.pendingAction = null;
            gameState.currentOpponent = null;
            actionButtons.classList.remove('hidden');
            actionBusy.classList.add('hidden');
            
            // Reset scouting report button
            const scoutBtn = document.getElementById('scout-opponent-btn');
            scoutBtn.disabled = false;
            document.getElementById('scout-report-text').classList.add('hidden');
            document.getElementById('scout-report-error').classList.add('hidden');
            
            closeModal();
        }

        function simulateFight(forceLoss = false, forceWin = false) {
            showModal('modal-fight-sim');
            
            const simLog = document.getElementById('fight-sim-log');
            const resultText = document.getElementById('fight-result-text');
            const payoutText = document.getElementById('fight-payout-text');
            simLog.innerHTML = ""; // Clear log
            resultText.textContent = "";
            payoutText.textContent = "";

            const player = gameState.stats;
            const opp = gameState.currentOpponent;

            let playerHealth = 100;
            let oppHealth = 100;
            let rounds = 3;

            function logRound(msg) {
                const p = document.createElement('p');
                p.textContent = msg;
                simLog.appendChild(p);
                simLog.scrollTop = simLog.scrollHeight; // Auto-scroll
            }

            logRound(`--- Fight vs. ${opp.name} begins! ---`);

            for (let r = 1; r <= rounds; r++) {
                if (playerHealth <= 0 || oppHealth <= 0) break;

                logRound(`--- Round ${r} ---`);

                // Striking Exchange
                let playerStrike = (player.striking + player.strength) * (Math.random() + 0.5);
                let oppStrike = (opp.striking + (opp.grappling / 2)) * (Math.random() + 0.5); // Use opp's stats

                if (playerStrike > oppStrike) {
                    let dmg = Math.floor(playerStrike - oppStrike);
                    oppHealth -= dmg;
                    logRound(`${gameState.playerName} lands a clean shot! (-${dmg} HP)`);
                } else {
                    let dmg = Math.floor(oppStrike - playerStrike);
                    playerHealth -= dmg;
                    logRound(`${opp.name} counters! (-${dmg} HP)`);
                }

                if (playerHealth <= 0 || oppHealth <= 0) break;

                // Grappling Exchange
                let playerGrapple = (player.grappling + player.strength) * (Math.random() + 0.5);
                let oppGrapple = (opp.grappling + (opp.striking / 2)) * (Math.random() + 0.5); // Use opp's stats

                if (playerGrapple > oppGrapple) {
                    let dmg = Math.floor(playerGrapple - oppGrapple);
                    oppHealth -= dmg;
                    logRound(`${gameState.playerName} controls the clinch! (-${dmg} HP)`);
                } else {
                    let dmg = Math.floor(oppGrapple - playerGrapple);
                    playerHealth -= dmg;
                    logRound(`${opp.name} gets a takedown! (-${dmg} HP)`);
                }
            }

            // --- Determine Winner ---
            let win = false;
            
            // Check for forced outcomes
            if (forceLoss) {
                win = false;
                resultText.textContent = "You lost! (Took a Dive)";
                resultText.classList.add('text-yellow-400');
                resultText.classList.remove('text-green-400', 'text-red-400');

                // Check for getting caught
                if (Math.random() < 0.25) { // 25% chance of getting caught
                    let fameLoss = 50;
                    gameState.stats.fame = Math.max(0, gameState.stats.fame - fameLoss);
                    addLogMessage("You were caught taking a dive! Your reputation is ruined.", 'danger');
                    addLogMessage(`You lose ${fameLoss} fame!`, 'danger');
                }

            } else if (forceWin) {
                win = true;
                resultText.textContent = "YOU WON! (Mob Help)";
                resultText.classList.add('text-green-400');
                resultText.classList.remove('text-yellow-400', 'text-red-400');
            }
            // Normal outcome
            else if (playerHealth > oppHealth) {
                win = true;
                resultText.textContent = "YOU WON!";
                resultText.classList.add('text-green-400');
                resultText.classList.remove('text-yellow-400', 'text-red-400');
            } else {
                win = false;
                resultText.textContent = "You lost.";
                resultText.classList.add('text-red-400');
                resultText.classList.remove('text-green-400', 'text-yellow-400');
            }


            // --- Payouts & Stats ---
            let payout = 0;
            let healthLoss = 100 - playerHealth;
            healthLoss = Math.max(10, healthLoss); // Minimum 10 health loss

            if (win) {
                payout = opp.purseWin;
                gameState.record.wins++;
                gameState.stats.fame += 5;
                addLogMessage(`You won against ${opp.name}! +$${payout}, +5 Fame, -${healthLoss} Health.`, 'success');

                if (forceWin) {
                    let mobCut = Math.floor(payout * 0.5); // Mob takes 50%
                    payout -= mobCut;
                    addLogMessage(`The mob takes their cut... -$${mobCut}`, 'danger');
                }

            } else {
                payout = opp.purseLose;
                gameState.record.losses++;
                gameState.stats.fame += 1;
                addLogMessage(`You lost to ${opp.name}. +$${payout}, +1 Fame, -${healthLoss} Health.`, 'warning');
            }

            gameState.stats.money += payout;
            gameState.stats.health -= healthLoss;
            payoutText.textContent = `Payout: $${payout}, Health Lost: ${healthLoss}`;

            // Reset flags
            gameState.currentOpponent = null;
            gameState.isTakingDive = false;
            gameState.isMobHelping = false;
            
            // Finish the week (this also updates UI and resets busy state)
            finishWeek();
        }


        // --- UI & Modals ---

        function updateUI() {
            // Stats Panel
            document.getElementById('hub-date').textContent = `Week ${gameState.week}, ${gameState.year}`;
            document.getElementById('hub-money').textContent = `$${gameState.stats.money}`;
            document.getElementById('hub-record').textContent = `Record: ${gameState.record.wins}-${gameState.record.losses}-${gameState.record.draws}`;

            document.getElementById('stat-health-text').textContent = `${gameState.stats.health} / ${gameState.stats.maxHealth}`;
            document.getElementById('stat-health-bar').style.width = `${(gameState.stats.health / gameState.stats.maxHealth) * 100}%`;
            
            document.getElementById('stat-stamina-text').textContent = `${gameState.stats.stamina} / ${gameState.stats.maxStamina}`;
            document.getElementById('stat-stamina-bar').style.width = `${(gameState.stats.stamina / gameState.stats.maxStamina) * 100}%`;

            document.getElementById('stat-striking').textContent = gameState.stats.striking;
            document.getElementById('stat-grappling').textContent = gameState.stats.grappling;
            document.getElementById('stat-strength').textContent = gameState.stats.strength;
            document.getElementById('stat-fame').textContent = gameState.stats.fame;

            // Update money color
            const moneyEl = document.getElementById('hub-money');
            if (gameState.stats.money < 0) {
                moneyEl.classList.add('text-red-500');
                moneyEl.classList.remove('text-green-400');
            } else {
                moneyEl.classList.remove('text-red-500');
                moneyEl.classList.add('text-green-400');
            }
        }
        
        function gameOver(title, description) {
            document.getElementById('game-over-title').textContent = title;
            document.getElementById('game-over-description').textContent = description;
            showModal('modal-game-over');
        }

        function showModal(modalId) {
            modalBackdrop.classList.remove('hidden');
            modalContainer.classList.remove('hidden');
            
            allModals.forEach(modal => modal.classList.add('hidden'));
            
            const activeModal = document.getElementById(modalId);
            if (activeModal) {
                activeModal.classList.remove('hidden');
            } else {
                console.error(`Modal with ID ${modalId} not found.`);
            }
        }

        function closeModal(callback = null) {
            modalBackdrop.classList.add('hidden');
            modalContainer.classList.add('hidden');
            allModals.forEach(modal => modal.classList.add('hidden'));

            // Reset state if closing fight modal
            if (!gameState.pendingAction) { // Only reset if not in middle of action
                 gameState.isBusy = false;
            }
           
            // This logic was moved to declineFight() to prevent bug
            // if (gameState.currentOpponent) {
            //    gameState.currentOpponent = null;
            // }

            // Execute callback if one exists (e.g., finishWeek)
            if (callback && typeof callback === 'function') {
                callback();
            }
        }

        // --- Utility Functions ---
        function addLogMessage(message, type = 'normal') {
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span class="font-bold text-gray-400">[Week ${gameState.week}]</span> ${message}`;
            
            switch(type) {
                case 'success':
                    logEntry.classList.add('text-green-400');
                    break;
                case 'warning':
                    logEntry.classList.add('text-yellow-400');
                    break;
                case 'danger':
                    logEntry.classList.add('text-red-400');
                    break;
                case 'info':
                    logEntry.classList.add('text-blue-300');
                    break;
                default:
                    logEntry.classList.add('text-gray-200');
open
            }
            
            // Add to top of log
            eventLog.prepend(logEntry);
        }

        // --- Init ---
        // Add event listener to career path buttons
        document.querySelectorAll('.career-path-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.career-path-btn').forEach(b => b.classList.remove('bg-blue-600', 'text-white'));
                btn.classList.add('bg-blue-600', 'text-white');
                disciplineSelect.classList.remove('hidden');
                startGameBtn.disabled = false;
            });
        });

    </script>
</body>
</html>
